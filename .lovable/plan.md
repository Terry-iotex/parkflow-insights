

# 🎢 游乐园实时运营指挥系统 (Park Operation Control System)

## 项目概述
一个支持中英文双语的游乐园实时运营指挥平台，利用 Trio API 的视觉 AI 能力分析直播流，结合模拟数据展示完整的游客流量管理、排队监控和智能运营决策能力。核心卖点：**帮助减少排队投诉，提高游客满意度**。

---

## 技术架构
- **前端**：React + Tailwind + Recharts 图表 + shadcn/ui 组件
- **后端**：Lovable Cloud Edge Functions（代理 Trio API 调用，接收 Webhook）
- **数据**：模拟数据引擎 + Trio API 实时分析结果
- **直播源**：YouTube Live（演示用 https://www.youtube.com/watch?v=m15UeZ_WtHk）

---

## 页面结构 & 功能

### 1️⃣ 顶部导航 + 语言切换
- 六大模块导航：Dashboard / Attractions / Crowd Analytics / Queue Monitor / Alerts / Reports
- 中英文一键切换
- 全局状态栏：当前总人数、Crowd Stress Index（0-100）、活跃告警数

### 2️⃣ Dashboard（总览首页）⭐ 核心页面
**左侧 - 可视化园区地图**
- SVG 交互式园区地图，展示各游乐项目位置
- 热力图覆盖，用颜色（绿/黄/红）显示各区域拥挤程度
- 点击项目弹出详情卡片（排队长度、预计等待、30分钟趋势）

**右侧 - 实时指标面板**
- 当前总游客数（模拟数据 + 动态变化）
- 今日峰值 & 当前对比
- 拥堵项目 TOP 5 排行
- 等待时间排行榜
- Crowd Stress Index 仪表盘（0-100分，综合密度/速度/排队/聚集度）

**Trio API 集成点**：用 `/check-once` 分析直播流中的人群密度状况，结果展示在地图上的对应区域

### 3️⃣ Attractions（项目管理）
- 预设 6-8 个热门项目（过山车、旋转木马、摩天轮等）
- 每个项目卡片显示：当前状态、排队人数、预计等待、运营建议
- 点击进入项目详情：历史趋势图、峰值分析、AI 分析结果

### 4️⃣ Queue Monitor（排队监控）⭐ 重点功能
- 所有项目实时等待时间表格 + 排序
- 趋势折线图（过去1小时 + 未来30分钟预测）
- 排队速度变化曲线
- 预测时间对比（AI预测 vs 实际）

**Trio API 集成点**：
- 用 `/check-once` 定期检查排队区域状况（如"排队区域是否超过50人？"）
- 用 `/live-digest` 获取排队场景的持续摘要

### 5️⃣ Crowd Analytics（人流分析）
- 区域热力图回放（模拟时间轴播放）
- 游客流动路径可视化（主动线、停留点、冷区标注）
- 停留时间分析柱状图
- 高峰时段对比（今日 vs 历史平均）
- 游客分布饼图

### 6️⃣ Alerts（预警中心）
- 实时告警列表：拥堵预警、安全预警、排队超时预警
- 告警等级分类（严重/警告/提示）
- 每条告警含 AI 解释 + 建议操作

**Trio API 集成点**：用 `/live-monitor` 设置持续监控条件（如"是否出现大规模人群聚集"），触发时通过 Webhook 接收告警

### 7️⃣ Reports（报表中心）
- 每日运营报告摘要
- 关键指标趋势（日/周/月）
- 游客满意度模型推算（基于等待时间）
- 运营效率评分

---

## 运营决策引擎 ⭐ 差异化亮点
系统不仅展示数据，还主动给出运营建议：
- "🚨 过山车排队已超45分钟，建议开放临时通道"
- "📢 建议 APP 推送分流提示引导游客前往冷区"
- "👷 建议增加2名工作人员到旋转木马区域"
- "⏰ 建议延长摩天轮开放时间至21:00"

建议以卡片形式出现在 Dashboard 底部和 Alerts 页面

---

## 模拟数据引擎
- 自动生成逼真的游客流量波动（上午缓增、午后高峰、傍晚回落）
- 各项目独立的排队数据曲线
- 随机事件触发（突发拥堵、设备故障等）
- 数据每10秒自动刷新，模拟实时效果

---

## Edge Function（轻量后端）
- **trio-proxy**：代理前端对 Trio API 的调用，隐藏 API Key
- **trio-webhook**：接收 `/live-monitor` 的 Webhook 回调
- 不使用数据库，数据存在前端内存/状态中

---

## 实施顺序
1. **基础框架**：路由、导航、语言切换、全局布局
2. **模拟数据引擎**：生成逼真的游乐园运营数据
3. **Dashboard 页面**：园区地图 + 热力图 + 指标面板
4. **Queue Monitor**：排队监控表格 + 趋势图 + 预测
5. **Edge Function + Trio API 集成**：代理调用 + 实时分析
6. **Alerts 预警中心**：告警列表 + 运营建议
7. **Crowd Analytics**：人流分析可视化
8. **Attractions + Reports**：项目管理 + 报表
9. **Crowd Stress Index**：综合评分仪表盘
10. **打磨 UI & 双语完善**

